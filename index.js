!function(){"use strict";var e={936:function(e,t,n){t.__esModule=!0;var r=n(518),i=n(736),o="badge badge-pill badge-";r.default.component("bond-row",{props:["row"],template:"#bond-row-template",computed:{moexUrl:function(){return"https://www.moex.com/ru/issue.aspx?code="+this.row.isin},ratingText:function(){return(0,i.ratingText)(this.row)},couponHintText:function(){return(0,i.couponHintText)(this.row)},couponValueText:function(){var e=this.row;return 4&e.couponFlags?"–":e.couponValues.next},listLevelBadgeClass:function(){var e=this.row;switch(e.listLevel){case 1:return o+"success";case 2:return o+"warning";case 3:return e.isHighRisk?o+"dark bond-finder-ir-badge":o+"danger"}},listLevelName:function(){var e=this.row;switch(e.listLevel){case 1:return"I";case 2:return"II";case 3:return e.isHighRisk?" ":"III"}},showCouponStar:function(){return!!(8&this.row.couponFlags)},showCouponHint:function(){return!!(2&this.row.couponFlags)},rowClass:function(){return this.row.infoUrl?"bond-finder-separator":null}}})},639:function(e,t){t.__esModule=!0,t.calcCouponFlags=t.toCouponValues=void 0,t.toCouponValues=function(e){var t=e.length,n=t>0?e[0]:0;return{next:n,remainingAvg:t>1?e[1]:n}},t.calcCouponFlags=function(e){var t=e.next,n=e.remainingAvg,r=0,i=null!=t&&null!=n;i||(r|=8);var o=0===t&&0===n;return o&&(r|=4),i&&!o&&t===n&&(r|=1),i&&n<t&&(r|=2),r}},669:function(e,t,n){t.__esModule=!0;var r=n(639),i=n(385),o=["bond-finder-lab.github.io/backend","storage.yandexcloud.net/bond-finder","global.s3.cloud.ru/bond-finder"],a=Date.now()%3,u="report-cache-v1",s="date",c=i.default.load(s)||"";function l(e){try{return function(e){for(var t=e.cols,n=e.rows,i={},o=t.length-1;o>=0;o--)i[t[o]]=o;var a="rub"in i;return{date:e.date,rows:n.map((function(e){var t,n=e[i.isin],o=e[i.name],u=e[i.sector],s=e[i.list_level],c=e[i.total_trades_perc],l=e[i.maturity_date],d=e[i.min_days_between_amort],f=e[i.coupon_months],p=(0,r.toCouponValues)(e[i.coupon_values]),m=e[i.close_yield],h=!!e[i.has_offer],g=!!e[i.in_abi],v=!!e[i.in_cbhy],w=!!e[i.high_risk],y=!!e[i.qual],b=!a||!!e[i.rub],M=e[i.rating],x=e[i.waprice],C=e[i.amort_range_days],_=!!e[i.pending],k=B("ПК"),A=B("ИН");function B(e){return 1===u&&"ОФЗ-"===o.substring(0,4)&&o.substring(4,6)===e}return{isin:n,name:o,sector:u,listLevel:s,totalTradesPerc:c,maturityDate:l,minDaysBetweenAmort:d,couponMonths:f,couponValues:p,closeYield:m,hasOffer:h,inABI:g,inCBHY:v,isHighRisk:w,isQualOnly:y,rub:b,rating:M,waprice:x,amortRangeDays:C,pending:_,isOFZPK:k,isOFZIN:A,currentYield:(t=p.remainingAvg||p.next,t&&x?100*t/x:0),couponFlags:(0,r.calcCouponFlags)(p),hasFutureAmort:d>0,fits:!1,top:!1,infoUrl:""}}))}}(JSON.parse(e))}catch(e){return{error:!0,date:"",rows:[]}}}function d(e,t){var n="https://"+o[(a+e)%3]+"/report-v1.json?_="+Date.now(),r=2===e,f=new XMLHttpRequest;f.open("GET",n,!0),f.timeout=1e3*(r?10:3),f.onreadystatechange=function(){if(4===this.readyState){var n=this.status,o=this.responseText;!function(n){var o=l(n);if(o.error||o.date<c){if(!r)return void d(1+e,t);o=l(i.default.load(u))}else i.default.save(u,n),i.default.save(s,o.date);t(o)}(200===n?o:"")}},f.send()}t.default=function(e){return d(0,e)}},644:function(e,t,n){t.__esModule=!0;var r,i,o=n(385),a="night",u=!1;function s(e,t,n){var r=e.classList;n?r.add(t):r.remove(t)}function c(){s(document.documentElement,"night",r<0?function(){try{return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches}catch(e){return!1}}():r>0)}i=o.default.load(a),r=null==i?-1:Number(i),document.addEventListener("scroll",(function(){var e=window.pageYOffset>0;u!==e&&(s(document.documentElement,"scrolled",e),u=e)}),!1),t.default={getMode:function(){return r},setMode:function(e){r=e,o.default.save(a,e),c()},updateMarkup:c}},736:function(e,t){function n(e){switch(e.rating){case 6:return"AAA";case 5.1:return"AA+";case 5:return"AA";case 4.9:return"AA-";case 4.1:return"A+";case 4:return"A";case 3.9:return"A-";case 3.1:return"BBB+";case 3:return"BBB";case 2.9:return"BBB-";case 2.1:return"BB+";case 2:return"BB";case 1.9:return"BB-";case 1.1:return"B+";case 1:return"B";case.9:return"B-"}return"–"}function r(e){var t=e.couponFlags;return 2&t?" ↓":8&t?"**":""}function i(e,t,n){for(void 0===n&&(n=!1);e.length<t;)n?e=" "+e:e+=" ";return e}t.__esModule=!0,t.toTsvLine=t.toTsvHeader=t.couponHintText=t.ratingText=void 0,t.ratingText=n,t.couponHintText=r,t.toTsvHeader=function(){return[i("isin",12),i("name",12),i("",7),i("list",4,!0),i("rating",6),i("mat_date",10),"",i("wa_price",8,!0),"",i("coupon",8,!0),"",i("yield",8,!0)].join("\t")},t.toTsvLine=function(e){function t(e){return i(null==e?"":e+"",8,!0)}return[e.isin,i(e.name,12),(o=[],e.isQualOnly?o.push("кв"):e.inABI?o.push("*"):e.inCBHY&&o.push("вд"),e.isHighRisk&&o.push("пир"),i(o.join(", "),7)),i(e.listLevel+"",4,!0),i(n(e),6),e.maturityDate,e.hasFutureAmort?"A":"",t(e.waprice),r(e),t(e.couponValues.next),e.hasOffer?"оф":"",t(e.closeYield)].join("\t");var o}},451:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};t.__esModule=!0,t.setMinCurrentYield=t.getMinCurrentYield=t.minRatingModApplicable=t.save=t.load=void 0;var i=n(385),o="settings-v1",a=new Date,u=new Date(a.getFullYear()+1,a.getMonth(),1),s=new Date(a.getFullYear()+5,a.getMonth(),1);function c(e){var t=1+e.getMonth();return t>9?t+"":"0"+t}var l={rub:!0,min_month:c(u),month:c(s),min_year:u.getFullYear()+"",year:s.getFullYear()+"",sector1:!0,sector2:!0,sector3:!0,govOnly:!1,highRisk:!1,qual:!1,offer:!1,maxListLevel:"2",minRating:"4",minRatingMod:"-0.1",maxPerYear:"-1",requiredCouponMonth:"0",couponType:"0",minCurrentYield:"",minCurrentYieldOther:"",maxAmort:"90",minTotalTradesPerc:"50"};t.load=function(){var e=r({},l),t=i.default.load(o,!0);if(t&&"object"==typeof t)for(var n=0,a=Object.keys(l);n<a.length;n++){var u=a[n];u in t&&(e[u]=t[u])}return"3"===e.couponType&&(e.couponType="2",e.offer=!0),e},t.save=function(e){i.default.save(o,e,!0)},t.minRatingModApplicable=function(e){return e>0&&e<6},t.getMinCurrentYield=function(e){return e.rub?e.minCurrentYield:e.minCurrentYieldOther},t.setMinCurrentYield=function(e,t){e.rub?e.minCurrentYield=t:e.minCurrentYieldOther=t}},385:function(e,t){function n(e){return"bond-finder-"+e}t.__esModule=!0,t.default={load:function(e,t){void 0===t&&(t=!1);try{var r=localStorage.getItem(n(e));return t&&null!=r?JSON.parse(r):r}catch(e){return null}},save:function(e,t,r){void 0===r&&(r=!1);try{localStorage.setItem(n(e),(r?JSON.stringify:String)(t))}catch(e){}}}},3:function(e,t,n){t.__esModule=!0,t.applySettings=void 0;var r=n(451),i=n(451);function o(e){return e.length<4?"2000":e.length>4?"3000":e}t.applySettings=function(e){(0,r.save)(e.settings);for(var t=e.settings,n=t.rub,a=[o(t.min_year),t.min_month,"01"].join("-"),u=[o(t.year),t.month,"31"].join("-"),s=Number(t.maxListLevel),c=Number(t.minRating),l=Number(t.minRatingMod),d=Number(t.maxPerYear),f=Number(t.requiredCouponMonth),p=Number(t.maxAmort),m=Number(t.minTotalTradesPerc),h=Number((0,i.getMinCurrentYield)(t)),g=Number(t.couponType),v=g<2,w=g<1,y=(0,r.minRatingModApplicable)(c)?c+l:c,b=0,M=!1,x=!1,C=!1,_=!1,k=!1,A=!1,B=!1,T=!1,Y=!1,O=!1,F=0,R=e.reportRows;F<R.length;F++){var L=R[F];if(b<1e3&&N(L)){var H=L.couponFlags;b++,L.fits=!0,L.top=b<=20,T=T||L.hasFutureAmort,M=M||L.inABI,x=x||L.inCBHY,C=C||L.isHighRisk,_=_||L.isQualOnly,k=k||!!(2&H),A=A||!!(8&H),B=B||L.hasOffer,L.infoUrl="",L.closeYield||(!Y&&L.isOFZPK?(Y=!0,L.infoUrl="https://bcs-express.ru/novosti-i-analitika/ofz-pk-s-priviazkoi-k-ruonia-kak-zashchitit-sredstva-ot-infliatsii"):!O&&L.isOFZIN&&(O=!0,L.infoUrl="https://bcs-express.ru/novosti-i-analitika/ofz-in-ili-kak-garantirovano-zashchitit-sebia-ot-infliatsii"))}else L.fits=L.top=!1}function N(e){if(e.pending)return!1;if(e.rub!==n)return!1;if(e.isHighRisk&&!t.highRisk)return!1;if(e.isQualOnly&&!t.qual)return!1;if(e.hasOffer&&!t.offer)return!1;if(e.listLevel>s)return!1;if(e.rating<y)return!1;var r=e.couponFlags;if(v&&8&r)return!1;if(w&&!(1&r))return!1;if(h>0&&e.currentYield<h)return!1;if(e.totalTradesPerc<m)return!1;if(e.maturityDate<a||e.maturityDate>u)return!1;if(n){if(t.sector1||t.sector2||t.sector3){if(1===e.sector&&!t.sector1)return!1;if(2===e.sector&&!t.sector2)return!1;if(3===e.sector&&!t.sector3)return!1}}else if(t.govOnly&&1!==e.sector)return!1;var i=-12===e.couponMonths[0];if(d>-1){if(i)return!1;if(e.couponMonths.length>d)return!1}if(-12===d&&!i)return!1;if(f>0&&!i&&e.couponMonths.indexOf(f)<0)return!1;if(e.hasFutureAmort){if(-1===p)return!1;if(p>0&&e.minDaysBetweenAmort<p)return!1;if(p<-1&&e.amortRangeDays>-p)return!1}return!0}e.totalFits=b,e.showAll=b/20<1.5,e.hasABI=M,e.hasCBHY=x,e.hasHighRisk=C,e.hasQualOnly=_,e.hasDownstairs=k,e.hasNonFixed=A,e.hasOffer=B,e.hasFutureAmort=T,e.showClipboardCheck=!1}},518:function(e){e.exports={default:Vue}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}!function(){var e=n(518);n(936);var t=n(669),r=n(644),i=n(736),o=n(451),a=n(451),u=n(385),s=n(3),c=Date.now(),l="vue-root",d=window.cordova,f={nightMode:r.default.getMode(),collapseForm:window.matchMedia&&window.matchMedia("(max-width: 992px)").matches,settings:(0,o.load)(),reportRows:[]};function p(){Date.now()-c>1234e3&&location.reload()}function m(e){return"INPUT"===e.tagName}function h(){for(var e=[(0,i.toTsvHeader)()],t=0,n=f.reportRows;t<n.length;t++){var r=n[t];r.fits&&e.push((0,i.toTsvLine)(r))}var o=e.join("\n");function a(){d||(f.showClipboardCheck=!0)}function u(){alert("Не получилось")}if(d)d.exec(a,u,"CordovaPluginUtils","clipboardWrite",[o]);else try{navigator.clipboard.writeText(o).then(a,u)}catch(e){u()}}r.default.updateMarkup(),d?(document.addEventListener("deviceready",(function(){document.addEventListener("resume",p,!1)}),!1),document.addEventListener("deviceconfigchange",(function(){r.default.updateMarkup()}),!1),document.documentElement.style.userSelect="none",document.addEventListener("click",(function(e){var t=e.target;"A"!==t.tagName||function(e){if(!e)return!0;var t=e.indexOf("moex.com/")>-1?"moex":"other",n="confirm-external-link-"+t;if(!u.default.load(n)){if(!confirm("Пожалуйста, подтвердите переход на "+("moex"===t?"сайт Московской Биржи":"внешний сайт")))return!1;u.default.save(n,"1")}return!0}(t.href)||(e.preventDefault(),e.stopPropagation())}),!1),document.addEventListener("click",(function(e){var t=e.target;if(m(t)){var n=t.getBoundingClientRect().bottom-innerHeight/2;if(n>0)try{scrollBy({behavior:"smooth",top:n})}catch(e){scrollBy(0,n)}}}),!1)):(document.addEventListener("wheel",(function(e){var t=e.target;document.activeElement===t&&m(t)&&e.preventDefault()}),{passive:!1}),function(){for(var e={".":!0,"-":!0},t=0;t<10;t++)e[t]=!0;document.addEventListener("keypress",(function(t){var n=t.target;if(m(n)&&"number"===n.type){var r=t.key||String.fromCharCode(t.keyCode);e[r]||t.preventDefault()}}),{passive:!1})}()),(0,t.default)((function(t){f.reportDate=t.date,f.reportRows=t.rows;var n,i=t.error;f.reportError=i,(0,s.applySettings)(f),new e.default({el:"#"+l,data:f,watch:{nightMode:{handler:function(e){return r.default.setMode(e)}},settings:{deep:!0,handler:function(){return(0,s.applySettings)(f)}}},methods:{alertClose:function(){return u.default.save("alert-v1",!0)},clipboardButtonClick:h},computed:{minRatingModVisible:function(){return(0,o.minRatingModApplicable)(Number(this.settings.minRating))},minCurrentYieldThunk:{get:function(){return(0,a.getMinCurrentYield)(this.settings)},set:function(e){(0,a.setMinCurrentYield)(this.settings,e)}}}}),document.getElementById(l).style.display="",document.getElementById("bond-finder-loading").style.display="none",d||((n=document.documentElement).style.fontSize="medium",n.style.fontSize=1600/parseFloat(getComputedStyle(n).fontSize)+"%")}))}()}();
//# sourceMappingURL=index.js.map